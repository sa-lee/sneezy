<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introducing sneezy • sneezy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introducing sneezy">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sneezy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sneezy.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pbmc3k.html">pbmc3k</a>
    </li>
    <li>
      <a href="../articles/pdfsense.html">pdfsense: or understanding high dimensional parameter space</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sa-lee/sneezy">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introducing sneezy</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sa-lee/sneezy/blob/master/vignettes/sneezy.Rmd"><code>vignettes/sneezy.Rmd</code></a></small>
      <div class="hidden name"><code>sneezy.Rmd</code></div>

    </div>

    
    
<div id="exploring-non-linear-embeddings-with-sneezy" class="section level1">
<h1 class="hasAnchor">
<a href="#exploring-non-linear-embeddings-with-sneezy" class="anchor"></a>Exploring non-linear embeddings with sneezy</h1>
<p>The goal of sneezy is to allow a user to exlpore non-linear embedding algorithms such as t-SNE and UMAP in the context of global geometry of the original high dimensional space. It does this in a few ways:</p>
<ul>
<li>generating a tour of the original (high dimensional) data set</li>
<li>estimating and visualising nearest neighbor graphs in the original and embedding space</li>
<li>providing numerical and visual diagnostics to determine the quality of the embedding</li>
</ul>
<p>It provides a unified interface to a selection of embedding methods and nearest neighbor estimation methods.</p>
<p>This vignette walks through basic usage of sneezy to get you familiar with the data structures and methods available. For more advanced useage with ‘realistic’ analysis scenarios see the <a href="">pbmc3k</a> and <a href="">pdfsense</a> vignettes.</p>
</div>
<div id="the-multi-challenge-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#the-multi-challenge-dataset" class="anchor"></a>The multi-challenge dataset</h1>
<p>sneezy comes preloaded with a benchmark from the <a href="http://ifs.tuwien.ac.at/dm/dataSets.html">multi-challenge dataset</a>.</p>
<p>This data arrives as a simple <code>data.frame</code> that contains a key indicating the challenge id and an index giving the observation id for that particular challenge, the remaining coordinates are the dimensions.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(SingleCellExperiment)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sneezy)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(multi)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt;   key index         X1         X2         X3 X4 X5 X6 X7 X8 X9 X10</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; 1   A     1 -0.7680942 -1.0628993 -1.5028950  0  0  0  0  0  0   0</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; 2   A     2 -1.3264069 -0.7257062 -1.4368393  0  0  0  0  0  0   0</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; 3   A     3 -0.8705006 -0.9446138 -0.7961634  0  0  0  0  0  0   0</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; 4   A     4 -1.1982279 -0.6339961 -1.0319850  0  0  0  0  0  0   0</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; 5   A     5 -0.5812532 -0.8399788 -0.7622555  0  0  0  0  0  0   0</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; 6   A     6 -1.0888959 -1.3565734 -1.1500098  0  0  0  0  0  0   0</span></a></code></pre></div>
<div id="the-tourexperiment-object" class="section level2">
<h2 class="hasAnchor">
<a href="#the-tourexperiment-object" class="anchor"></a>The TourExperiment object</h2>
<p>In order to keep track of the embeddings and transformations on the numerical parts of the data, sneezy creates a data structure called a TourExperiment. It extends the <code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html">SingleCellExperiment::SingleCellExperiment()</a></code> object with two additional slots called <code>basisSets</code> and <code>neighborSets</code>, we will describe their use in more detail shortly.</p>
<p>A TourExperiment object can be created directly from a data.frame or a matrix as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">multi_te &lt;-<span class="st"> </span><span class="kw"><a href="../reference/TourExperiment-class.html">TourExperiment</a></span>(multi,</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">                           <span class="dt">basisSets =</span> <span class="kw">SimpleList</span>(),</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">                           <span class="dt">neighborSets =</span> <span class="kw">SimpleList</span>(),</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                           X1<span class="op">:</span>X10)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">multi_te</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; class: TourExperiment </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; dim: 10 1000 </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; metadata(0):</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; assays(1): view</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; rownames(10): X1 X2 ... X9 X10</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; rowData names(0):</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; colnames: NULL</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; colData names(2): key index</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; reducedDimNames(0):</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; spikeNames(0):</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; altExpNames(0):</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; neighborSetNames(0): </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; basisSetNames(0):</span></a></code></pre></div>
<p>The last argument is the selection of columns that form the numeric data that we are interested in exploring the structure of, called an assay in the nonmelcature of bioinformatics. Note this is transposed so rows are variables and columns are observations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># the x1 - x10 data</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">assay</span>(multi_te, <span class="st">"view"</span>)[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;           [,1]       [,2]       [,3]       [,4]       [,5]</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; X1  -0.7680942 -1.3264069 -0.8705006 -1.1982279 -0.5812532</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; X2  -1.0628993 -0.7257062 -0.9446138 -0.6339961 -0.8399788</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; X3  -1.5028950 -1.4368393 -0.7961634 -1.0319850 -0.7622555</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; X4   0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; X5   0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; X6   0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; X7   0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; X8   0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; X9   0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; X10  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></a></code></pre></div>
</div>
<div id="making-shapes" class="section level2">
<h2 class="hasAnchor">
<a href="#making-shapes" class="anchor"></a>Making Shapes</h2>
<p>We will start with a simpler look of the data by selecting the keys “A” and “D”. This consists of two well sepearted Gaussian clusters in 10 dimensional space (with same covariance matrix), and two 3-dimensional Gaussian clusters embeded in 10 dimensional space. One of the clusters has more granular structure and consists of three sub clusters. From the multichallenge dataset page this subset is described as follows:</p>
<blockquote>
<p>The first subset consists of a Gaussian cluster and another cluster that is itself divided into three Gaussian clusters, all of them living in a three-dimensional space. This subset is used to demonstrate how an algorithm deals with different levels of granularity in cluster structures. The distance between the centers of the two main clusters, i.e. the the big cluster and the cluster that consists of the three smaller ones, is 5 times the standard deviation d of the first main cluster. The three smaller clusters are arranged around the center of the second cluster, which they themselves form, on a circle of radius 5-d equidistant from each other. The three 3 small cluster centers and the center of the large cluster lie in the same plane. The small clusters each have a standard deviation of d and one third of the number of 3 data points of the large cluster.</p>
</blockquote>
<p>First we will subset the <code>multi_te</code> object:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">multi_te2 &lt;-<span class="st"> </span>multi_te[, <span class="kw">colData</span>(multi_te)<span class="op">$</span>key <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"D"</span>)]</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">colData</span>(multi_te2)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw">colData</span>(multi_te2)<span class="op">$</span>key <span class="op">==</span><span class="st"> "A"</span>, </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">                                    <span class="st">"sub-gaussian"</span>, </a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                                    <span class="st">"10-d 2x cluster"</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">multi_te2</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; class: TourExperiment </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; dim: 10 400 </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; metadata(0):</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; assays(1): view</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; rownames(10): X1 X2 ... X9 X10</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; rowData names(0):</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; colnames: NULL</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; colData names(3): key index labels</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; reducedDimNames(0):</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; spikeNames(0):</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; altExpNames(0):</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; neighborSetNames(0): </span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; basisSetNames(0):</span></a></code></pre></div>
<p>We can get a view of the structure using exact principal components via the <code>embed_linear</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">multi_te2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/embed_linear.html">embed_linear</a></span>(multi_te2, </a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                          <span class="dt">num_comp =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(multi_te2),</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                          <span class="dt">.on =</span> <span class="st">"view"</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                          <span class="dt">center =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                          <span class="dt">.engine =</span> <span class="kw"><a href="../reference/le-backends.html">pca_exact</a></span>())</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">multi_te2</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; class: TourExperiment </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; dim: 10 400 </span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; metadata(0):</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; assays(1): view</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; rownames(10): X1 X2 ... X9 X10</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; rowData names(0):</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; colnames: NULL</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; colData names(3): key index labels</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; reducedDimNames(1): pca_exact</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; spikeNames(0):</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; altExpNames(0):</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; neighborSetNames(0): </span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; basisSetNames(0):</span></a></code></pre></div>
<p>This adds an element to the reducedDims slot called <code><a href="../reference/le-backends.html">pca_exact()</a></code> that stores the sample factors, and loadings for the principal components.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">pcs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDim</a></span>(multi_te2, <span class="st">"pca_exact"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">pcs</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; class: LinearEmbeddingMatrix </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; dim: 400 10 </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; metadata(0):</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; rownames: NULL</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; colnames(10): PC1 PC2 ... PC9 PC10</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; factorData names(1): sdev</span></a></code></pre></div>
<p>The resulting principal components can be viewed via ggplot2:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(pcs), <span class="dt">labels =</span> <span class="kw">colData</span>(multi_te2)<span class="op">$</span>labels),</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> PC1, <span class="dt">y =</span> PC2)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">colour =</span> labels)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span>(<span class="dt">palette =</span> <span class="st">"Dark2"</span>)</a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>From the PCs we can clearly see the separation of the two 10-d clusters but cannot see the finer structure in the sub-gaussian clusters.</p>
<p>At this point we can compute exact t-SNE for a given perpelexity and exaggeration factor alpha:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1010010</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">multi_te2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/embed_nonlinear.html">embed_nonlinear</a></span>(</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  multi_te2,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  <span class="dt">num_comp =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  <span class="dt">.on =</span> <span class="st">"view"</span>, </a>
<a class="sourceLine" id="cb8-6" data-line-number="6">  <span class="dt">.engine =</span> <span class="kw"><a href="../reference/NonLinearEmbeddingParam-class.html">tsne_exact</a></span>(<span class="dt">perplexity =</span> <span class="dv">30</span>, <span class="dt">alpha =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(multi_te2) <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">tsne &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDim</a></span>(multi_te2, <span class="st">"tsne_exact"</span>)</a></code></pre></div>
<p>And we can follow the same approach as before for visualising the results:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">pl &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne), <span class="dt">labels =</span> <span class="kw">colData</span>(multi_te2)<span class="op">$</span>labels),</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> Dim1, <span class="dt">y =</span> Dim2)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">colour =</span> labels)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span>(<span class="dt">palette =</span> <span class="st">"Dark2"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.title =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(), </a>
<a class="sourceLine" id="cb9-8" data-line-number="8">        <span class="dt">axis.ticks =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(), </a>
<a class="sourceLine" id="cb9-9" data-line-number="9">        <span class="dt">axis.text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">        <span class="dt">panel.grid =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>())</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">pl  </a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>In this case it looks as though t-SNE has worked ok: it has identified the three subclusters of the second cluster for the orange points, and seperated the two ten dimensional clusters.</p>
<p>Next we can estimate the nearest neighbors on both the original dataset and in the embedding. This produces a matrix of indices for each row giving the nearest neighbor.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">multi_te2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/estimate_neighbors.html">estimate_neighbors</a></span>(multi_te2, <span class="dv">90</span>, <span class="dt">.on =</span> <span class="st">"view"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">multi_te2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/estimate_neighbors.html">estimate_neighbors</a></span>(multi_te2, <span class="dv">90</span>, <span class="dt">.on =</span> <span class="st">"tsne_exact"</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="kw"><a href="../reference/neighborSets.html">neighborSet</a></span>(multi_te2, <span class="st">"tsne_exact"</span>))</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; [1] 400  90</span></a></code></pre></div>
<p>You can then view the k-nearest neighbors graph overlaid on the scatter via the <code><a href="../reference/overlay-neighbors.html">overlay_neighbors()</a></code> function:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">pl <span class="op">+</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/overlay-neighbors.html">overlay_neighbors</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                    <span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb11-4" data-line-number="4">                    <span class="kw"><a href="../reference/neighborSets.html">neighborSet</a></span>(multi_te2, <span class="st">"tsne_exact"</span>),</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                    <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>This can give us a direct visualisation of how the difference between the emphasis t-SNE provides on local geometry by viewing the k-NN graph from the original dataset on the t-SNE layout.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">pl <span class="op">+</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/overlay-neighbors.html">overlay_neighbors</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">                    <span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb12-4" data-line-number="4">                    <span class="kw"><a href="../reference/neighborSets.html">neighborSet</a></span>(multi_te2, <span class="st">"view"</span>),</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">                    <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We can directly visualise the difference:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">pl <span class="op">+</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/overlay-neighbors-diff.html">overlay_difference_neighbors</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                    <span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb13-4" data-line-number="4">                    <span class="kw"><a href="../reference/neighborSets.html">neighborSet</a></span>(multi_te2, <span class="st">"view"</span>),</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                    <span class="kw"><a href="../reference/neighborSets.html">neighborSet</a></span>(multi_te2, <span class="st">"tsne_exact"</span>),</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">                    <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Or the intersection:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">pl <span class="op">+</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/overlay-neighbors-diff.html">overlay_intersect_neighbors</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                    <span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                    <span class="kw"><a href="../reference/neighborSets.html">neighborSet</a></span>(multi_te2, <span class="st">"view"</span>),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                    <span class="kw"><a href="../reference/neighborSets.html">neighborSet</a></span>(multi_te2, <span class="st">"tsne_exact"</span>),</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                    <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Sometimes the graph view can be messy, especially when there’s lots of neighbors. Instead we can estimate the centroids of clusters seen in the embedding by clustering the complete kNN or the shared nearest neighbor (sNN) graph. Note that this is heavily influenced by the use of</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">pl <span class="op">+</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/overlay-centroids.html">overlay_snn_centroids</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb15-3" data-line-number="3">                        <span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/LEM-getset.html">sampleFactors</a></span>(tsne)[,<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb15-4" data-line-number="4">                        <span class="kw"><a href="../reference/neighborSets.html">neighborSet</a></span>(multi_te2, <span class="st">"tsne_exact"</span>),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">                        <span class="dt">color =</span> <span class="st">"red"</span>) </a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="viewing-high-dimensional-space" class="section level2">
<h2 class="hasAnchor">
<a href="#viewing-high-dimensional-space" class="anchor"></a>Viewing high-dimensional space</h2>
<p>We can also tour around a data space, and see how the nearest neighbours graph from t-SNE space is preserved in high-dimensional space. We can take view the entire k-NN or s-NN graph in the embedding space. This allows us to see how t-SNE preserves local topology. First we generate a basis set on the for our tour, which will form part of our <code>TourExperiment</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1999</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">multi_te2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/generate_bases.html">generate_bases</a></span>(multi_te2, <span class="dt">.on =</span> <span class="st">"view"</span>, <span class="dt">max_bases =</span> <span class="dv">300</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw"><a href="../reference/basisSets.html">basisSetNames</a></span>(multi_te2)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt; [1] "view"</span></a></code></pre></div>
<p>Then we can animate the tour view and overlay the neighbors with the following:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gganimate)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">pal &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#1B9E77"</span>,<span class="st">"#D95F02"</span>)[<span class="kw"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">colData</span>(multi_te2)<span class="op">$</span>labels))]</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw"><a href="../reference/sneezy_neighbors.html">sneezy_neighbors</a></span>(multi_te2, <span class="st">"view"</span>, <span class="st">"tsne_exact"</span>, <span class="dt">col =</span> pal)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt; Using half_range 1.2</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7">Frame <span class="dv">1</span> (<span class="dv">1</span>%)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">Frame <span class="dv">2</span> (<span class="dv">2</span>%)</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">Frame <span class="dv">3</span> (<span class="dv">3</span>%)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10">Frame <span class="dv">4</span> (<span class="dv">4</span>%)</a>
<a class="sourceLine" id="cb17-11" data-line-number="11">Frame <span class="dv">5</span> (<span class="dv">5</span>%)</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">Frame <span class="dv">6</span> (<span class="dv">6</span>%)</a>
<a class="sourceLine" id="cb17-13" data-line-number="13">Frame <span class="dv">7</span> (<span class="dv">7</span>%)</a>
<a class="sourceLine" id="cb17-14" data-line-number="14">Frame <span class="dv">8</span> (<span class="dv">8</span>%)</a>
<a class="sourceLine" id="cb17-15" data-line-number="15">Frame <span class="dv">9</span> (<span class="dv">9</span>%)</a>
<a class="sourceLine" id="cb17-16" data-line-number="16">Frame <span class="dv">10</span> (<span class="dv">10</span>%)</a>
<a class="sourceLine" id="cb17-17" data-line-number="17">Frame <span class="dv">11</span> (<span class="dv">11</span>%)</a>
<a class="sourceLine" id="cb17-18" data-line-number="18">Frame <span class="dv">12</span> (<span class="dv">12</span>%)</a>
<a class="sourceLine" id="cb17-19" data-line-number="19">Frame <span class="dv">13</span> (<span class="dv">13</span>%)</a>
<a class="sourceLine" id="cb17-20" data-line-number="20">Frame <span class="dv">14</span> (<span class="dv">14</span>%)</a>
<a class="sourceLine" id="cb17-21" data-line-number="21">Frame <span class="dv">15</span> (<span class="dv">15</span>%)</a>
<a class="sourceLine" id="cb17-22" data-line-number="22">Frame <span class="dv">16</span> (<span class="dv">16</span>%)</a>
<a class="sourceLine" id="cb17-23" data-line-number="23">Frame <span class="dv">17</span> (<span class="dv">17</span>%)</a>
<a class="sourceLine" id="cb17-24" data-line-number="24">Frame <span class="dv">18</span> (<span class="dv">18</span>%)</a>
<a class="sourceLine" id="cb17-25" data-line-number="25">Frame <span class="dv">19</span> (<span class="dv">19</span>%)</a>
<a class="sourceLine" id="cb17-26" data-line-number="26">Frame <span class="dv">20</span> (<span class="dv">20</span>%)</a>
<a class="sourceLine" id="cb17-27" data-line-number="27">Frame <span class="dv">21</span> (<span class="dv">21</span>%)</a>
<a class="sourceLine" id="cb17-28" data-line-number="28">Frame <span class="dv">22</span> (<span class="dv">22</span>%)</a>
<a class="sourceLine" id="cb17-29" data-line-number="29">Frame <span class="dv">23</span> (<span class="dv">23</span>%)</a>
<a class="sourceLine" id="cb17-30" data-line-number="30">Frame <span class="dv">24</span> (<span class="dv">24</span>%)</a>
<a class="sourceLine" id="cb17-31" data-line-number="31">Frame <span class="dv">25</span> (<span class="dv">25</span>%)</a>
<a class="sourceLine" id="cb17-32" data-line-number="32">Frame <span class="dv">26</span> (<span class="dv">26</span>%)</a>
<a class="sourceLine" id="cb17-33" data-line-number="33">Frame <span class="dv">27</span> (<span class="dv">27</span>%)</a>
<a class="sourceLine" id="cb17-34" data-line-number="34">Frame <span class="dv">28</span> (<span class="dv">28</span>%)</a>
<a class="sourceLine" id="cb17-35" data-line-number="35">Frame <span class="dv">29</span> (<span class="dv">29</span>%)</a>
<a class="sourceLine" id="cb17-36" data-line-number="36">Frame <span class="dv">30</span> (<span class="dv">30</span>%)</a>
<a class="sourceLine" id="cb17-37" data-line-number="37">Frame <span class="dv">31</span> (<span class="dv">31</span>%)</a>
<a class="sourceLine" id="cb17-38" data-line-number="38">Frame <span class="dv">32</span> (<span class="dv">32</span>%)</a>
<a class="sourceLine" id="cb17-39" data-line-number="39">Frame <span class="dv">33</span> (<span class="dv">33</span>%)</a>
<a class="sourceLine" id="cb17-40" data-line-number="40">Frame <span class="dv">34</span> (<span class="dv">34</span>%)</a>
<a class="sourceLine" id="cb17-41" data-line-number="41">Frame <span class="dv">35</span> (<span class="dv">35</span>%)</a>
<a class="sourceLine" id="cb17-42" data-line-number="42">Frame <span class="dv">36</span> (<span class="dv">36</span>%)</a>
<a class="sourceLine" id="cb17-43" data-line-number="43">Frame <span class="dv">37</span> (<span class="dv">37</span>%)</a>
<a class="sourceLine" id="cb17-44" data-line-number="44">Frame <span class="dv">38</span> (<span class="dv">38</span>%)</a>
<a class="sourceLine" id="cb17-45" data-line-number="45">Frame <span class="dv">39</span> (<span class="dv">39</span>%)</a>
<a class="sourceLine" id="cb17-46" data-line-number="46">Frame <span class="dv">40</span> (<span class="dv">40</span>%)</a>
<a class="sourceLine" id="cb17-47" data-line-number="47">Frame <span class="dv">41</span> (<span class="dv">41</span>%)</a>
<a class="sourceLine" id="cb17-48" data-line-number="48">Frame <span class="dv">42</span> (<span class="dv">42</span>%)</a>
<a class="sourceLine" id="cb17-49" data-line-number="49">Frame <span class="dv">43</span> (<span class="dv">43</span>%)</a>
<a class="sourceLine" id="cb17-50" data-line-number="50">Frame <span class="dv">44</span> (<span class="dv">44</span>%)</a>
<a class="sourceLine" id="cb17-51" data-line-number="51">Frame <span class="dv">45</span> (<span class="dv">45</span>%)</a>
<a class="sourceLine" id="cb17-52" data-line-number="52">Frame <span class="dv">46</span> (<span class="dv">46</span>%)</a>
<a class="sourceLine" id="cb17-53" data-line-number="53">Frame <span class="dv">47</span> (<span class="dv">47</span>%)</a>
<a class="sourceLine" id="cb17-54" data-line-number="54">Frame <span class="dv">48</span> (<span class="dv">48</span>%)</a>
<a class="sourceLine" id="cb17-55" data-line-number="55">Frame <span class="dv">49</span> (<span class="dv">49</span>%)</a>
<a class="sourceLine" id="cb17-56" data-line-number="56">Frame <span class="dv">50</span> (<span class="dv">50</span>%)</a>
<a class="sourceLine" id="cb17-57" data-line-number="57">Frame <span class="dv">51</span> (<span class="dv">51</span>%)</a>
<a class="sourceLine" id="cb17-58" data-line-number="58">Frame <span class="dv">52</span> (<span class="dv">52</span>%)</a>
<a class="sourceLine" id="cb17-59" data-line-number="59">Frame <span class="dv">53</span> (<span class="dv">53</span>%)</a>
<a class="sourceLine" id="cb17-60" data-line-number="60">Frame <span class="dv">54</span> (<span class="dv">54</span>%)</a>
<a class="sourceLine" id="cb17-61" data-line-number="61">Frame <span class="dv">55</span> (<span class="dv">55</span>%)</a>
<a class="sourceLine" id="cb17-62" data-line-number="62">Frame <span class="dv">56</span> (<span class="dv">56</span>%)</a>
<a class="sourceLine" id="cb17-63" data-line-number="63">Frame <span class="dv">57</span> (<span class="dv">57</span>%)</a>
<a class="sourceLine" id="cb17-64" data-line-number="64">Frame <span class="dv">58</span> (<span class="dv">58</span>%)</a>
<a class="sourceLine" id="cb17-65" data-line-number="65">Frame <span class="dv">59</span> (<span class="dv">59</span>%)</a>
<a class="sourceLine" id="cb17-66" data-line-number="66">Frame <span class="dv">60</span> (<span class="dv">60</span>%)</a>
<a class="sourceLine" id="cb17-67" data-line-number="67">Frame <span class="dv">61</span> (<span class="dv">61</span>%)</a>
<a class="sourceLine" id="cb17-68" data-line-number="68">Frame <span class="dv">62</span> (<span class="dv">62</span>%)</a>
<a class="sourceLine" id="cb17-69" data-line-number="69">Frame <span class="dv">63</span> (<span class="dv">63</span>%)</a>
<a class="sourceLine" id="cb17-70" data-line-number="70">Frame <span class="dv">64</span> (<span class="dv">64</span>%)</a>
<a class="sourceLine" id="cb17-71" data-line-number="71">Frame <span class="dv">65</span> (<span class="dv">65</span>%)</a>
<a class="sourceLine" id="cb17-72" data-line-number="72">Frame <span class="dv">66</span> (<span class="dv">66</span>%)</a>
<a class="sourceLine" id="cb17-73" data-line-number="73">Frame <span class="dv">67</span> (<span class="dv">67</span>%)</a>
<a class="sourceLine" id="cb17-74" data-line-number="74">Frame <span class="dv">68</span> (<span class="dv">68</span>%)</a>
<a class="sourceLine" id="cb17-75" data-line-number="75">Frame <span class="dv">69</span> (<span class="dv">69</span>%)</a>
<a class="sourceLine" id="cb17-76" data-line-number="76">Frame <span class="dv">70</span> (<span class="dv">70</span>%)</a>
<a class="sourceLine" id="cb17-77" data-line-number="77">Frame <span class="dv">71</span> (<span class="dv">71</span>%)</a>
<a class="sourceLine" id="cb17-78" data-line-number="78">Frame <span class="dv">72</span> (<span class="dv">72</span>%)</a>
<a class="sourceLine" id="cb17-79" data-line-number="79">Frame <span class="dv">73</span> (<span class="dv">73</span>%)</a>
<a class="sourceLine" id="cb17-80" data-line-number="80">Frame <span class="dv">74</span> (<span class="dv">74</span>%)</a>
<a class="sourceLine" id="cb17-81" data-line-number="81">Frame <span class="dv">75</span> (<span class="dv">75</span>%)</a>
<a class="sourceLine" id="cb17-82" data-line-number="82">Frame <span class="dv">76</span> (<span class="dv">76</span>%)</a>
<a class="sourceLine" id="cb17-83" data-line-number="83">Frame <span class="dv">77</span> (<span class="dv">77</span>%)</a>
<a class="sourceLine" id="cb17-84" data-line-number="84">Frame <span class="dv">78</span> (<span class="dv">78</span>%)</a>
<a class="sourceLine" id="cb17-85" data-line-number="85">Frame <span class="dv">79</span> (<span class="dv">79</span>%)</a>
<a class="sourceLine" id="cb17-86" data-line-number="86">Frame <span class="dv">80</span> (<span class="dv">80</span>%)</a>
<a class="sourceLine" id="cb17-87" data-line-number="87">Frame <span class="dv">81</span> (<span class="dv">81</span>%)</a>
<a class="sourceLine" id="cb17-88" data-line-number="88">Frame <span class="dv">82</span> (<span class="dv">82</span>%)</a>
<a class="sourceLine" id="cb17-89" data-line-number="89">Frame <span class="dv">83</span> (<span class="dv">83</span>%)</a>
<a class="sourceLine" id="cb17-90" data-line-number="90">Frame <span class="dv">84</span> (<span class="dv">84</span>%)</a>
<a class="sourceLine" id="cb17-91" data-line-number="91">Frame <span class="dv">85</span> (<span class="dv">85</span>%)</a>
<a class="sourceLine" id="cb17-92" data-line-number="92">Frame <span class="dv">86</span> (<span class="dv">86</span>%)</a>
<a class="sourceLine" id="cb17-93" data-line-number="93">Frame <span class="dv">87</span> (<span class="dv">87</span>%)</a>
<a class="sourceLine" id="cb17-94" data-line-number="94">Frame <span class="dv">88</span> (<span class="dv">88</span>%)</a>
<a class="sourceLine" id="cb17-95" data-line-number="95">Frame <span class="dv">89</span> (<span class="dv">89</span>%)</a>
<a class="sourceLine" id="cb17-96" data-line-number="96">Frame <span class="dv">90</span> (<span class="dv">90</span>%)</a>
<a class="sourceLine" id="cb17-97" data-line-number="97">Frame <span class="dv">91</span> (<span class="dv">91</span>%)</a>
<a class="sourceLine" id="cb17-98" data-line-number="98">Frame <span class="dv">92</span> (<span class="dv">92</span>%)</a>
<a class="sourceLine" id="cb17-99" data-line-number="99">Frame <span class="dv">93</span> (<span class="dv">93</span>%)</a>
<a class="sourceLine" id="cb17-100" data-line-number="100">Frame <span class="dv">94</span> (<span class="dv">94</span>%)</a>
<a class="sourceLine" id="cb17-101" data-line-number="101">Frame <span class="dv">95</span> (<span class="dv">95</span>%)</a>
<a class="sourceLine" id="cb17-102" data-line-number="102">Frame <span class="dv">96</span> (<span class="dv">96</span>%)</a>
<a class="sourceLine" id="cb17-103" data-line-number="103">Frame <span class="dv">97</span> (<span class="dv">97</span>%)</a>
<a class="sourceLine" id="cb17-104" data-line-number="104">Frame <span class="dv">98</span> (<span class="dv">98</span>%)</a>
<a class="sourceLine" id="cb17-105" data-line-number="105">Frame <span class="dv">99</span> (<span class="dv">99</span>%)</a>
<a class="sourceLine" id="cb17-106" data-line-number="106">Frame <span class="dv">100</span> (<span class="dv">100</span>%)</a>
<a class="sourceLine" id="cb17-107" data-line-number="107"><span class="co">#&gt; Finalizing encoding... done!</span></a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-18-1.gif"><!-- --></p>
<p>And look at the centroids in the original space of the nearest neighbours graph in t-SNE space:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/sneezy_centroids.html">sneezy_centroids</a></span>(multi_te2, <span class="st">"view"</span>, <span class="st">"tsne_exact"</span>, <span class="dt">col =</span> pal)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; Using half_range 1.2</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">Frame <span class="dv">1</span> (<span class="dv">1</span>%)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">Frame <span class="dv">2</span> (<span class="dv">2</span>%)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">Frame <span class="dv">3</span> (<span class="dv">3</span>%)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">Frame <span class="dv">4</span> (<span class="dv">4</span>%)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">Frame <span class="dv">5</span> (<span class="dv">5</span>%)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">Frame <span class="dv">6</span> (<span class="dv">6</span>%)</a>
<a class="sourceLine" id="cb18-10" data-line-number="10">Frame <span class="dv">7</span> (<span class="dv">7</span>%)</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">Frame <span class="dv">8</span> (<span class="dv">8</span>%)</a>
<a class="sourceLine" id="cb18-12" data-line-number="12">Frame <span class="dv">9</span> (<span class="dv">9</span>%)</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">Frame <span class="dv">10</span> (<span class="dv">10</span>%)</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">Frame <span class="dv">11</span> (<span class="dv">11</span>%)</a>
<a class="sourceLine" id="cb18-15" data-line-number="15">Frame <span class="dv">12</span> (<span class="dv">12</span>%)</a>
<a class="sourceLine" id="cb18-16" data-line-number="16">Frame <span class="dv">13</span> (<span class="dv">13</span>%)</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">Frame <span class="dv">14</span> (<span class="dv">14</span>%)</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">Frame <span class="dv">15</span> (<span class="dv">15</span>%)</a>
<a class="sourceLine" id="cb18-19" data-line-number="19">Frame <span class="dv">16</span> (<span class="dv">16</span>%)</a>
<a class="sourceLine" id="cb18-20" data-line-number="20">Frame <span class="dv">17</span> (<span class="dv">17</span>%)</a>
<a class="sourceLine" id="cb18-21" data-line-number="21">Frame <span class="dv">18</span> (<span class="dv">18</span>%)</a>
<a class="sourceLine" id="cb18-22" data-line-number="22">Frame <span class="dv">19</span> (<span class="dv">19</span>%)</a>
<a class="sourceLine" id="cb18-23" data-line-number="23">Frame <span class="dv">20</span> (<span class="dv">20</span>%)</a>
<a class="sourceLine" id="cb18-24" data-line-number="24">Frame <span class="dv">21</span> (<span class="dv">21</span>%)</a>
<a class="sourceLine" id="cb18-25" data-line-number="25">Frame <span class="dv">22</span> (<span class="dv">22</span>%)</a>
<a class="sourceLine" id="cb18-26" data-line-number="26">Frame <span class="dv">23</span> (<span class="dv">23</span>%)</a>
<a class="sourceLine" id="cb18-27" data-line-number="27">Frame <span class="dv">24</span> (<span class="dv">24</span>%)</a>
<a class="sourceLine" id="cb18-28" data-line-number="28">Frame <span class="dv">25</span> (<span class="dv">25</span>%)</a>
<a class="sourceLine" id="cb18-29" data-line-number="29">Frame <span class="dv">26</span> (<span class="dv">26</span>%)</a>
<a class="sourceLine" id="cb18-30" data-line-number="30">Frame <span class="dv">27</span> (<span class="dv">27</span>%)</a>
<a class="sourceLine" id="cb18-31" data-line-number="31">Frame <span class="dv">28</span> (<span class="dv">28</span>%)</a>
<a class="sourceLine" id="cb18-32" data-line-number="32">Frame <span class="dv">29</span> (<span class="dv">29</span>%)</a>
<a class="sourceLine" id="cb18-33" data-line-number="33">Frame <span class="dv">30</span> (<span class="dv">30</span>%)</a>
<a class="sourceLine" id="cb18-34" data-line-number="34">Frame <span class="dv">31</span> (<span class="dv">31</span>%)</a>
<a class="sourceLine" id="cb18-35" data-line-number="35">Frame <span class="dv">32</span> (<span class="dv">32</span>%)</a>
<a class="sourceLine" id="cb18-36" data-line-number="36">Frame <span class="dv">33</span> (<span class="dv">33</span>%)</a>
<a class="sourceLine" id="cb18-37" data-line-number="37">Frame <span class="dv">34</span> (<span class="dv">34</span>%)</a>
<a class="sourceLine" id="cb18-38" data-line-number="38">Frame <span class="dv">35</span> (<span class="dv">35</span>%)</a>
<a class="sourceLine" id="cb18-39" data-line-number="39">Frame <span class="dv">36</span> (<span class="dv">36</span>%)</a>
<a class="sourceLine" id="cb18-40" data-line-number="40">Frame <span class="dv">37</span> (<span class="dv">37</span>%)</a>
<a class="sourceLine" id="cb18-41" data-line-number="41">Frame <span class="dv">38</span> (<span class="dv">38</span>%)</a>
<a class="sourceLine" id="cb18-42" data-line-number="42">Frame <span class="dv">39</span> (<span class="dv">39</span>%)</a>
<a class="sourceLine" id="cb18-43" data-line-number="43">Frame <span class="dv">40</span> (<span class="dv">40</span>%)</a>
<a class="sourceLine" id="cb18-44" data-line-number="44">Frame <span class="dv">41</span> (<span class="dv">41</span>%)</a>
<a class="sourceLine" id="cb18-45" data-line-number="45">Frame <span class="dv">42</span> (<span class="dv">42</span>%)</a>
<a class="sourceLine" id="cb18-46" data-line-number="46">Frame <span class="dv">43</span> (<span class="dv">43</span>%)</a>
<a class="sourceLine" id="cb18-47" data-line-number="47">Frame <span class="dv">44</span> (<span class="dv">44</span>%)</a>
<a class="sourceLine" id="cb18-48" data-line-number="48">Frame <span class="dv">45</span> (<span class="dv">45</span>%)</a>
<a class="sourceLine" id="cb18-49" data-line-number="49">Frame <span class="dv">46</span> (<span class="dv">46</span>%)</a>
<a class="sourceLine" id="cb18-50" data-line-number="50">Frame <span class="dv">47</span> (<span class="dv">47</span>%)</a>
<a class="sourceLine" id="cb18-51" data-line-number="51">Frame <span class="dv">48</span> (<span class="dv">48</span>%)</a>
<a class="sourceLine" id="cb18-52" data-line-number="52">Frame <span class="dv">49</span> (<span class="dv">49</span>%)</a>
<a class="sourceLine" id="cb18-53" data-line-number="53">Frame <span class="dv">50</span> (<span class="dv">50</span>%)</a>
<a class="sourceLine" id="cb18-54" data-line-number="54">Frame <span class="dv">51</span> (<span class="dv">51</span>%)</a>
<a class="sourceLine" id="cb18-55" data-line-number="55">Frame <span class="dv">52</span> (<span class="dv">52</span>%)</a>
<a class="sourceLine" id="cb18-56" data-line-number="56">Frame <span class="dv">53</span> (<span class="dv">53</span>%)</a>
<a class="sourceLine" id="cb18-57" data-line-number="57">Frame <span class="dv">54</span> (<span class="dv">54</span>%)</a>
<a class="sourceLine" id="cb18-58" data-line-number="58">Frame <span class="dv">55</span> (<span class="dv">55</span>%)</a>
<a class="sourceLine" id="cb18-59" data-line-number="59">Frame <span class="dv">56</span> (<span class="dv">56</span>%)</a>
<a class="sourceLine" id="cb18-60" data-line-number="60">Frame <span class="dv">57</span> (<span class="dv">57</span>%)</a>
<a class="sourceLine" id="cb18-61" data-line-number="61">Frame <span class="dv">58</span> (<span class="dv">58</span>%)</a>
<a class="sourceLine" id="cb18-62" data-line-number="62">Frame <span class="dv">59</span> (<span class="dv">59</span>%)</a>
<a class="sourceLine" id="cb18-63" data-line-number="63">Frame <span class="dv">60</span> (<span class="dv">60</span>%)</a>
<a class="sourceLine" id="cb18-64" data-line-number="64">Frame <span class="dv">61</span> (<span class="dv">61</span>%)</a>
<a class="sourceLine" id="cb18-65" data-line-number="65">Frame <span class="dv">62</span> (<span class="dv">62</span>%)</a>
<a class="sourceLine" id="cb18-66" data-line-number="66">Frame <span class="dv">63</span> (<span class="dv">63</span>%)</a>
<a class="sourceLine" id="cb18-67" data-line-number="67">Frame <span class="dv">64</span> (<span class="dv">64</span>%)</a>
<a class="sourceLine" id="cb18-68" data-line-number="68">Frame <span class="dv">65</span> (<span class="dv">65</span>%)</a>
<a class="sourceLine" id="cb18-69" data-line-number="69">Frame <span class="dv">66</span> (<span class="dv">66</span>%)</a>
<a class="sourceLine" id="cb18-70" data-line-number="70">Frame <span class="dv">67</span> (<span class="dv">67</span>%)</a>
<a class="sourceLine" id="cb18-71" data-line-number="71">Frame <span class="dv">68</span> (<span class="dv">68</span>%)</a>
<a class="sourceLine" id="cb18-72" data-line-number="72">Frame <span class="dv">69</span> (<span class="dv">69</span>%)</a>
<a class="sourceLine" id="cb18-73" data-line-number="73">Frame <span class="dv">70</span> (<span class="dv">70</span>%)</a>
<a class="sourceLine" id="cb18-74" data-line-number="74">Frame <span class="dv">71</span> (<span class="dv">71</span>%)</a>
<a class="sourceLine" id="cb18-75" data-line-number="75">Frame <span class="dv">72</span> (<span class="dv">72</span>%)</a>
<a class="sourceLine" id="cb18-76" data-line-number="76">Frame <span class="dv">73</span> (<span class="dv">73</span>%)</a>
<a class="sourceLine" id="cb18-77" data-line-number="77">Frame <span class="dv">74</span> (<span class="dv">74</span>%)</a>
<a class="sourceLine" id="cb18-78" data-line-number="78">Frame <span class="dv">75</span> (<span class="dv">75</span>%)</a>
<a class="sourceLine" id="cb18-79" data-line-number="79">Frame <span class="dv">76</span> (<span class="dv">76</span>%)</a>
<a class="sourceLine" id="cb18-80" data-line-number="80">Frame <span class="dv">77</span> (<span class="dv">77</span>%)</a>
<a class="sourceLine" id="cb18-81" data-line-number="81">Frame <span class="dv">78</span> (<span class="dv">78</span>%)</a>
<a class="sourceLine" id="cb18-82" data-line-number="82">Frame <span class="dv">79</span> (<span class="dv">79</span>%)</a>
<a class="sourceLine" id="cb18-83" data-line-number="83">Frame <span class="dv">80</span> (<span class="dv">80</span>%)</a>
<a class="sourceLine" id="cb18-84" data-line-number="84">Frame <span class="dv">81</span> (<span class="dv">81</span>%)</a>
<a class="sourceLine" id="cb18-85" data-line-number="85">Frame <span class="dv">82</span> (<span class="dv">82</span>%)</a>
<a class="sourceLine" id="cb18-86" data-line-number="86">Frame <span class="dv">83</span> (<span class="dv">83</span>%)</a>
<a class="sourceLine" id="cb18-87" data-line-number="87">Frame <span class="dv">84</span> (<span class="dv">84</span>%)</a>
<a class="sourceLine" id="cb18-88" data-line-number="88">Frame <span class="dv">85</span> (<span class="dv">85</span>%)</a>
<a class="sourceLine" id="cb18-89" data-line-number="89">Frame <span class="dv">86</span> (<span class="dv">86</span>%)</a>
<a class="sourceLine" id="cb18-90" data-line-number="90">Frame <span class="dv">87</span> (<span class="dv">87</span>%)</a>
<a class="sourceLine" id="cb18-91" data-line-number="91">Frame <span class="dv">88</span> (<span class="dv">88</span>%)</a>
<a class="sourceLine" id="cb18-92" data-line-number="92">Frame <span class="dv">89</span> (<span class="dv">89</span>%)</a>
<a class="sourceLine" id="cb18-93" data-line-number="93">Frame <span class="dv">90</span> (<span class="dv">90</span>%)</a>
<a class="sourceLine" id="cb18-94" data-line-number="94">Frame <span class="dv">91</span> (<span class="dv">91</span>%)</a>
<a class="sourceLine" id="cb18-95" data-line-number="95">Frame <span class="dv">92</span> (<span class="dv">92</span>%)</a>
<a class="sourceLine" id="cb18-96" data-line-number="96">Frame <span class="dv">93</span> (<span class="dv">93</span>%)</a>
<a class="sourceLine" id="cb18-97" data-line-number="97">Frame <span class="dv">94</span> (<span class="dv">94</span>%)</a>
<a class="sourceLine" id="cb18-98" data-line-number="98">Frame <span class="dv">95</span> (<span class="dv">95</span>%)</a>
<a class="sourceLine" id="cb18-99" data-line-number="99">Frame <span class="dv">96</span> (<span class="dv">96</span>%)</a>
<a class="sourceLine" id="cb18-100" data-line-number="100">Frame <span class="dv">97</span> (<span class="dv">97</span>%)</a>
<a class="sourceLine" id="cb18-101" data-line-number="101">Frame <span class="dv">98</span> (<span class="dv">98</span>%)</a>
<a class="sourceLine" id="cb18-102" data-line-number="102">Frame <span class="dv">99</span> (<span class="dv">99</span>%)</a>
<a class="sourceLine" id="cb18-103" data-line-number="103">Frame <span class="dv">100</span> (<span class="dv">100</span>%)</a>
<a class="sourceLine" id="cb18-104" data-line-number="104"><span class="co">#&gt; Finalizing encoding... done!</span></a></code></pre></div>
<p><img src="sneezy_files/figure-html/unnamed-chunk-19-1.gif"><!-- --></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#exploring-non-linear-embeddings-with-sneezy">Exploring non-linear embeddings with sneezy</a></li>
      <li>
<a href="#the-multi-challenge-dataset">The multi-challenge dataset</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-tourexperiment-object">The TourExperiment object</a></li>
      <li><a href="#making-shapes">Making Shapes</a></li>
      <li><a href="#viewing-high-dimensional-space">Viewing high-dimensional space</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stuart Lee.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
