---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# sneezy

Explaining t-SNE via diagnostics and tours.

# Installation

```{r install, eval = FALSE}
remotes::install_github("sa-lee/sneezy")
```

# Quick start

sneezy comes preloaded with some datasets from the 
[multi-challenge dataset](http://ifs.tuwien.ac.at/dm/dataSets.html), to start
we will subset the data to only consider intertwined rings in three-dimensions.

```{r}
library(ggplot2)
library(gganimate)
library(sneezy)
tworings <- subset(multi, key == "C")
tworings

pc <- prcomp(tworings[, -c(1,2)])
ggplot(as.data.frame(pc$x), aes(PC1, PC2)) +
  geom_point() +
  coord_fixed(sqrt(pc$sdev[2] / pc$sdev[1]))
```

We can run the equivalent t-SNE, with our simplified wrapper which computes
exact t-SNE for a given perplexity. In this case t-SNE has broken the rings but
has not preserved the topology.
```{r}
set.seed(1999)
coords <- basic_tsne(tworings[, -c(1,2)], perplexity = 30)

ggplot(as.data.frame(coords$Y), aes(V1, V2)) +
  geom_point() +
  coord_fixed(sqrt(pc$sdev[2] / pc$sdev[1]))

```

We can also tour around a data space, and see how the nearest neighbours
graph from t-SNE space is preserved in high-dimensional space. We can take
subsets of the nn graph to see how the t-SNE preserves local topology 
(i.e. the point that are on the outer part of the first ring on the right, are
closest to points on the opposite ring)

```{r}
view_tour(as.matrix(tworings[, c(3,4,5)]), coords, .subset = 131)
```

We can also look at the t-SNE output in data space by taking the centroids
of nearest neighbour graph with respect to the data:

```{r}
view_tour_nn_centroids(as.matrix(tworings[, c(3,4,5)]), coords)
```

